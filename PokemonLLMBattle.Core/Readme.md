# 宝可梦AI对战框架设计
设计用于宝可梦对战AI的工作流框架，目前实现了关于PS对战的部分功能。

## 简介

宝可梦对战的状态空间十分复杂，如果采用强化学习方法进行学习训练，很可能会由于状态空间过大而导致训练效率低下，甚至无法收敛。并且随着世代的变更其复杂度也会进一步提升，道具/技能等等的效果太过复杂，难以直接使用强化学习完成这个任务（尤其是更为复杂的双打对战）。  
如果采用传统的专家系统，搜索树剪枝等，前提需要一个对战模拟器，PokemonShowdown是一个很好的模拟器，但较难跨语言进行调用。完成模拟器是一个需要很多手动工作的任务（不过如今ai时代，可以尝试让ai代劳翻译项目），本项目其实也非常需要一个计算器的存在帮助ai辅助判断。  

基于宝可梦对战的特点，尽管状态，道具，技能等内容非常多，不过其都有相应的文字描述。宝可梦对战本身作为回合制游戏，回合间有充足的思考时间，并且回合的决策是基于已有信息（预测信息）进行推理。这种场景反而较为适合使用大语言模型（LLM）来进行决策。

LLM数学计算能力较弱，但如果仅是基于文字推理，其表现可以有所期待，于是  
本项目的目标是设计一个宝可梦对战AI的工作流框架。

尽管是一个很简单的思路，但其实也是一个较为可行的方案，其能力随着框架和模型的发展会逐步提升，对于新规则的适应性也会较为强，也可以灵活的在连续战斗中调整战术

（目前基于老式ai项目魔改，对战相关的部分内容可能有奇怪的嵌套，待彻底去除）  

本质上，该框架就是将局面作为一道题传入到LLM中，LLM根据局面信息和战术信息进行推理，给出行动建议。  

不同的模型，其知识和能力不同，本框架，默认会将所有在场上的 道具/技能/特性等信息传入到模型中，模型会根据这些信息进行推理。

例如
```
KEEP THESE MOVE/ITEM/ABILITY KNOWLEDGE IN MIND WHEN EVALUATING MOVES AND EFFECTS\n1. Move Knowledge:\r\n[\r\n  {\r\n    \"move\": \"Electro Drift\",\r\n    \"description\": \"Damage is multiplied by 1.3333 if this move is super effective against the target.\",\r\n    \"type\": \"Electric\",\r\n    \"power\": 100,\r\n    \"accuracy\": 100,\r\n    \"priority\": 0\r\n  },\r\n  {\r\n    \"move\": \"Draco Meteor\",\r\n    \"description\": \"Lowers the user\\u0027s Special Attack by 2 stages.\",\r\n    \"type\": \"Dragon\",\r\n    \"power\": 130,\r\n    \"accuracy\": 90,\r\n    \"priority\": 0\r\n  },\r\n  {\r\n    \"move\": \"Snarl\",\r\n    \"description\": \"Has a 100% chance to lower the target\\u0027s Special Attack by 1 stage.\",\r\n    \"type\": \"Dark\",\r\n    \"power\": 55,\r\n    \"accuracy\": 95,\r\n 
```

## 战绩
目前最佳战绩在PS 规则I Bo3天梯中达到了1250分数左右  
首次实战选择了云嗨杯，尽管瑞士轮成绩仅1-5（1轮空）, 但是在bo3的小局中依然拿下了3个小局，并且其实也拥有拿下一整个bo3的可能性，可惜往往残局的不稳定发挥有可能一瞬间葬送优势（对于局势的判定能力有待加强）

## 行动
一场对战主要由以下三种操作组成
- 对战前选出出战宝可梦
- 对战中行动选择（换人/使用技能）
- 对战中强制换人（例如被击倒，U-turn等）

### 队伍选出（战前选出出战宝可梦）
此决策需要在对战正式开始前做出

#### 输入
- 队伍选出系统提示
- 队伍信息
- 队伍知识
- 队伍战术

### 强制换人
在某些情况下，例如被击倒，U-turn等，可能需要强制换人。

#### 输入
- 队伍选出系统提示
- 当前局面信息
- 当前局面知识
- 队伍战术/队伍选出时战术/(可能还有临时战术)
- 额外属性知识

### 选择技能/换人
最常规的操作，每回合开始做出选择

#### 输入
- 队伍选出系统提示
- 当前局面信息
- 当前局面知识
- 队伍战术/队伍选出时战术/(可能还有临时战术)
- 额外属性知识

## BO3

对于BO3对局，可能需要及时的调整战术，每当回合结束时，应当总结知识

